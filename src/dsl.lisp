(defpackage monomyth/dsl
  (:use :cl :monomyth/rmq-node :stmx :monomyth/node :monomyth/rmq-node-recipe
   :monomyth/rmq-worker :monomyth/worker :monomyth/node-recipe :monomyth/master)
  (:import-from :alexandria with-gensyms)
  (:export define-system define-rmq-node mashup-symbol build-queues))
(in-package :monomyth/dsl)

(defparameter *start-name* 'start)
(defparameter *end-name* 'end)

(defun mashup-symbol (&rest objects)
  "takes a bunch of symbols and combines them"
  (intern (format nil "狺镡赍泗螬┅ㄤ彐躅溴骈铄蝽癍铒溴轭翦蝾犰钺礤趄犷箧矧憝骢钽箫躜沐聃艴溴篝聃艴箝钺礤脲篝狎舡骖篝镳骖⑸铘弪钺骢钽糸镱翳狒泸遽翦翳蝽铒溴麸戾鲥骘蝽螽啜戾è钺礤脲ㄩ铘弪簌礅镬钺礤钺礤⑺刨紫夷┅趄犷筢泗轱钺ㄤ彐沆狍钺礤蝽癍铒溴ī┅ㄤ彐沆狍磲箬躔簌礅镬钺礤Л蝈汩疱蝽癍铒溴蝈汩疱īㄤ彐躅磲箬躔簌礅镬р蹰熹钺礤钺礤驷殪豉疱栾篝痫螋躞弪疳篌磲脲轭篝犷沐聃雉钺礤侯犴钺礤烘衢驷殪呼疱豉疱衡狒汨箝箝括殒溴篝聃艴啜轰弩溴篝聃艴濠Ж吼灬沐溴篝轭狒轱铋飑括殒箫躜沐聃艴啜后秕蜚箫躜沐聃艴濠Ж吼蹯飙箫躜沐铋飑恒镱箦趱瓠泔铑邈糸镱鸿矬栾篝吼矧痫螋乎箦蝾犴躞弪吼狍篦矧疳篌┅ㄤ彐躅磲箬躔簌礅镬р蹰熹钺礤Л蝈汩疱ī磲脲轭篝犷沐聃雉磲箬躔簌礅镬钺礤Л蝈汩疱┅呼疱钺礤脲┅ㄤ彐礤翳镤怩殪洵铒溴è黠螂弪蝽癍黠螂弪蝈汩疱磲箬躔簌礅镬钺礤Л蝈汩疱┅ì磲箬躔簌礅镬р蹰熹钺礤钺礤铒溴蝈汩疱钺礤驷殪聃艴蝈汩疱铒溴蝈汩疱豉疱蝈汩疱蝽癍黠螂弪栾篝黠螂弪蝽癍黠螂弪痫螋黠螂弪蝽癍黠螂弪躞弪钺礤黠螂弪蝽癍黠螂弪疳篌黠蜾黠螂弪┅ㄤ彐礤翳镤趄犷箧矧憝骖è铒溴钺礤轸屙ㄦ躅汜祆趄犷箧矧憝骢钽铒溴轸屙┅ㄩ篝狎舡骖换蜗耘澡轶礤翳镤轶蝓衡彐矧妣忮汜躞翳轶孱篚蝈翳狒翳换黠螂弪翳蝈徜栳铒忮孱篝狎翦麒孱翳躞弪泔溴屮邈豸弩啜溴骓弭栾篝狎趱衡彐矧è铒溴钺礤泔铘屮黠螂弪徜潋弩镳糸镱犰怩殪洵黠螂弪翳蝈徜ㄤ邈灬蝈ㄩ珙矧徕戾铒溴泔铘屮黠螂弪徜潋弩怩殪洵黠螂弪翳蝈徜┅ㄦ躅汜祆篝狎舡骖┅ㄩ篝镳骖换蜗耘澡轶礤翳镤轶蝓横骠弪忮汜躞翳轶孱篚蝈翳狒翳换黠螂弪翳蝈徜栳忮孱翦蝽轭狒邃麒孱翳躞弪泔溴屮邈豸弩啜溴骓弭栾箬豸滹黝横骠弪è铒溴钺礤┅ㄤ邈灬蝈ㄩ珙矧徕戾铒溴┅ㄦ躅汜祆篝镳骖┅┅ㄤ彐磲泸溴骈铄蝽癍铒溴钺礤趄犷箧矧憝骢钽箝脲箫躜沐聃艴溴篝聃艴篝狎舡骖篝镳骖⒛彐轭弩犰沆狍箦蟋礤翳镤蟋犷骢钽糸镱骘铄铒溴豉疱澡后翎螋骖犷后麸瓠骖箬秕熹骢钽糸镱翳狒翎脲铒狎珲礤铘犷狎躞邃麸屮翦钿翳铒溴篝狎趱犷箬豸滹黝礤翳镤螽鏖翳珏铙眢脲黠蜾簌愆ㄤ彐轭瀛蝽癍铒溴轭翦蝾犰钺礤趄犷箧矧憝骢钽箫躜沐聃艴溴篝聃艴箝脲黠蜾簌篝狎舡骖篝镳骖┅ㄤ彐躅怩殪洵聃艴弩瘐祆骈蝮痨徙瀛灬篝铒溴螬Ⅳ躜铙翳扉铄狎扉篝镦邃珏轭麸聃艴钺礤螈磲疸狎＇灬礅溽ㄦ轵篝铒溴箦泔钿铒溴ㄩㄡ钿ㄧ弭骈蝮舡铒溴侯犴濠ㄧ弭箦泔钿铒溴侯犴濠ㄦ矧磲铋岘麸幄ㄧ弭骈蝮舡铒溴侯犴濠ㄧ弭箦泔钿铒溴侯犴濠铋飑ㄣ镱啜侯犴ㄩ瘐祆骈蝮篝狎舡钺礤铋飑铒溴螬ㄡ痧孱铒溴啜ê钺礤ㄩ痨徙瀛灬篝孱洵钺礤铋飑┅┅ㄤ彐磲泸溴骈铄簌篝屙è脲瘐祆骈蝮舂痨徙瀛灬篝舂怙澌铒溴螬⒃犭弩扉篝镦痨轶ê钺礤烘衡狒汨箝镳糸镱犰后翎螋骖后麸瓠骖犷趱蝾翳屙轭麸蝽铒溴翳狒黠螂轭箦聃孱糸犰矧溴虍领蝈汩疱狎犰箫箦躔麸忮祜徜邃轭麸磲篝弪箦蝣弪鲩翳徜洵蝈汩疱礤翳镤澡后翎螋骖犷后麸瓠骖箬秕熹骢钽糸镱翳狒翎脲铒狎珲礤铘犷狎躞邃麸屮翦钿翳铒溴篝狎趱犷箬豸滹黝礤翳镤螽深翳簌篝屙鏖溴脲蟋瘐祆骈蝮犷痨徙瀛灬篝轭溟汜翦殒翳骈蝮铒溴箬秕熹瘐祆骝镯箫躜沐聃艴犷殒翳灬篝铒溴箬秕熹痨徙镱溴篝轭狒轱聃艴瀹戾è聃艴弩ㄢ蹰熹聃艴弩瘐祆骈蝮痨徙瀛灬篝铒溴螬┅啜痱镧括磲疸狎＇灬礅溽铒溴聃艴灞聃艴宀鏖翳珏铙眢钺礤脲ㄤ彐轭瀛蝽癍铒溴轭翦蝾犰ㄧ弭铒溴侯犴濠ㄧ弭铒溴烘瞟聃艴灞聃艴宀ㄧ弭铒溴衡狒汨箝濠钺礤脲ㄧ弭铒溴后翎螋骖ㄧ弭铒溴后麸瓠骖┅┅铒溴聃艴弩ㄣ潋聃艴弩┅ㄤ彐礤翳镤徜洵蝈汩疱è眢趄磲篝弪┅括磲疸狎＇灬礅溽铒溴啜徜洵蝈汩疱眢趄ì磲箬躔簌礅镬р蹰熹ㄧ弭铒溴侯犴濠Л蝈汩疱┅┅铒溴螬┅┅